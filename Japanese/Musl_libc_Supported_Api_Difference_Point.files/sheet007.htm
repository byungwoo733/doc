<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Excel.Sheet>
<meta name=Generator content="Microsoft Excel 15">
<link id=Main-File rel=Main-File
href="../Musl_libc_Supported_Api_Difference_Point.htm">
<link rel=File-List href=filelist.xml>
<link rel=Stylesheet href=stylesheet.css>
<style>
<!--table
	{mso-displayed-decimal-separator:"\.";
	mso-displayed-thousand-separator:"\,";}
@page
	{margin:.75in .7in .75in .7in;
	mso-header-margin:.3in;
	mso-footer-margin:.3in;}
-->
</style>
<![if !supportTabStrip]><script language="JavaScript">
<!--
function fnUpdateTabs()
 {
  if (parent.window.g_iIEVer>=4) {
   if (parent.document.readyState=="complete"
    && parent.frames['frTabs'].document.readyState=="complete")
   parent.fnSetActiveSheet(6);
  else
   window.setTimeout("fnUpdateTabs();",150);
 }
}

if (window.name!="frSheet")
 window.location.replace("../Musl_libc_Supported_Api_Difference_Point.htm");
else
 fnUpdateTabs();
//-->
</script>
<![endif]>
</head>

<body link=blue vlink=purple>

<table border=0 cellpadding=0 cellspacing=0 width=1077 style='border-collapse:
 collapse;table-layout:fixed;width:809pt'>
 <col width=34 style='mso-width-source:userset;mso-width-alt:1243;width:26pt'>
 <col class=xl65 width=27 style='mso-width-source:userset;mso-width-alt:987;
 width:20pt'>
 <col width=210 style='mso-width-source:userset;mso-width-alt:7680;width:158pt'>
 <col width=365 style='mso-width-source:userset;mso-width-alt:13348;width:274pt'>
 <col width=441 style='mso-width-source:userset;mso-width-alt:16128;width:331pt'>
 <tr height=21 style='height:15.75pt'>
  <td height=21 width=34 style='height:15.75pt;width:26pt'></td>
  <td class=xl65 width=27 style='width:20pt'></td>
  <td width=210 style='width:158pt'></td>
  <td width=365 style='width:274pt'></td>
  <td width=441 style='width:331pt'></td>
 </tr>
 <tr height=22 style='height:16.5pt'>
  <td height=22 style='height:16.5pt'></td>
  <td class=xl71 width=27 style='width:20pt'>No</td>
  <td class=xl72 width=210 style='width:158pt'>ケース</td>
  <td class=xl72 width=365 style='width:274pt'>相違点</td>
  <td class=xl72 width=441 style='width:331pt'>理由</td>
 </tr>
 <tr height=47 style='mso-height-source:userset;height:35.25pt'>
  <td height=47 style='height:35.25pt'></td>
  <td class=xl70 width=27 style='width:20pt'>1</td>
  <td class=xl68 width=210 style='width:158pt'>浮動小数点例外</td>
  <td class=xl68 width=365 style='width:274pt'>VEアーキテクチャーによる浮動小数点例外は、x86アーキテクチャーとは異なる場合があります。</td>
  <td class=xl68 width=441 style='width:331pt'>VEには非正規化数に対応するハードウェアがありません。</td>
 </tr>
 <tr height=40 style='mso-height-source:userset;height:30.0pt'>
  <td height=40 style='height:30.0pt'></td>
  <td rowspan=2 class=xl120 width=27 style='border-bottom:1.0pt solid black;
  border-top:none;width:20pt'>2</td>
  <td rowspan=2 class=xl119 width=210 style='border-bottom:1.0pt solid black;
  border-top:none;width:158pt'>open システムコール</td>
  <td class=xl69 width=365 style='width:274pt'>VEでは、ユーザープログラムによるopen（）の最初の呼び出しでは8が返されます。</td>
  <td rowspan=2 class=xl119 width=441 style='border-bottom:1.0pt solid black;
  border-top:none;width:331pt'>ドライバ・veosなどとの通信のような内部的な使用のために、擬似プロセスによってfdが使用されています。</td>
 </tr>
 <tr height=51 style='mso-height-source:userset;height:38.25pt'>
  <td height=51 style='height:38.25pt'></td>
  <td class=xl68 width=365 style='width:274pt'>Linuxでは、ユーザープログラムによるopen（）の呼び出しでは3が返されます。</td>
 </tr>
 <tr height=27 style='mso-height-source:userset;height:20.25pt'>
  <td height=27 style='height:20.25pt'></td>
  <td rowspan=2 class=xl120 width=27 style='border-bottom:1.0pt solid black;
  border-top:none;width:20pt'>3</td>
  <td rowspan=2 class=xl119 width=210 style='border-bottom:1.0pt solid black;
  border-top:none;width:158pt'>スレッドの最小スタックサイズ( PTHREAD_STACK_MIN)</td>
  <td class=xl69 width=365 style='width:274pt'>VEでは最小のスタックサイズは4MBです。</td>
  <td rowspan=2 class=xl119 width=441 style='border-bottom:1.0pt solid black;
  border-top:none;width:331pt'>VEアーキテクチャのためカスタマイズされています。</td>
 </tr>
 <tr height=41 style='height:30.75pt'>
  <td height=41 style='height:30.75pt'></td>
  <td class=xl68 width=365 style='width:274pt'>x86アーキテクチャに対し、glibcでは16KB、musl-libcでは2KBとなっています。</td>
 </tr>
 <tr height=109 style='mso-height-source:userset;height:81.75pt'>
  <td height=109 class=xl122 style='height:81.75pt'>&nbsp;</td>
  <td class=xl120 width=27 style='border-top:none;border-left:none;width:20pt'>4</td>
  <td class=xl119 width=210 style='border-top:none;border-left:none;width:158pt'>syscall()を使用してSIGCANCELシグナルを直接送信</td>
  <td class=xl123 width=365 style='border-top:none;border-left:none;width:274pt'>syscall（）（例：Kill（）、syscall（SYS_tgkill）など）を使用してSIGCANCELシグナルが送信されると、スレッドグループ全体がターゲットスレッドの代わりに終了します。</td>
  <td class=xl124 width=441 style='border-top:none;border-left:none;width:331pt'><br>
   
  glibcとは異なり、musl-libcはpthread_cancel（）が呼び出された後にSIGCANCELのハンドラをインストールします。したがって、SIGCANCELシグナルがpthread_cancel（）の呼び出しの前に送信されると、SIGCANCELのデフォルトアクションが終了するため、スレッドグループは終了します。</td>
 </tr>
 <tr height=361 style='height:270.75pt'>
  <td height=361 style='height:270.75pt'></td>
  <td class=xl130>5</td>
  <td class=xl127 width=210 style='width:158pt'>pthread_attr_setstack()
  によるスレッド用スタックサイズの指定</td>
  <td class=xl125 width=365 style='width:274pt'>pthread_attr_setstack() API
  でスレッド属性オブジェクトのスタックサイズ属性を指定してスレッドを生成した場合、スタックオーバーフローによるエラーが発生しません。</td>
  <td class=xl126 width=441 style='width:331pt'>スレッドAPI の Manpage
  に定義される動作は以下の通りです。<br>
    アプリケーションが pthread_attr_setstack() によってスレッドスタックを割り当てるとき、guard size
  属性は無視されます（libcによってガード領域は作成されません）。スタックのオーバーフローは（mprotect(2)
  でスタック用に確保した領域の終端にガード領域を指定するなどして）アプリケーションの責任で対処する必要があります。<br>
    VE では以下の様に動作が異なります。<br>
   
  ガード領域が（ユーザによって）指定された後であっても、スタックは領域の終端を超えて伸長し続けます。その結果は不定です。そのため、pthread_attr_setstack()
  は使うべきではありません。<br>
    <br>
    アプリケーションが子スレッドのスタックサイズを pthread_attr_setstacksize(3) で指定した場合は、この問題は発生しません。</td>
 </tr>
 <tr height=101 style='height:75.75pt'>
  <td height=101 style='height:75.75pt'></td>
  <td class=xl130 style='border-top:none'>6</td>
  <td class=xl127 width=210 style='border-top:none;width:158pt'>/etc/opt/nec/ve/musl/ld-musl-ve.path<span
  style='mso-spacerun:yes'> </span></td>
  <td class=xl125 width=365 style='border-top:none;width:274pt'>VE において、
  &quot;ld-musl-ve.path&quot; は 動的ライブラリを検索・ロードするパスの指定に使用されます。</td>
  <td class=xl126 width=441 style='border-top:none;width:331pt'>musl-libc
  におけるパスの検索順序は次の通りです。<br>
    1. VE_LD_LIBRARY_PATH<br>
    2. DT_RPATH/DT_RUNPATH (binutils )<br>
    3. /etc/opt/nec/ve/musl/ld-musl-ve.path<br>
    4. 標準パス (/opt/nec/ve/musl/lib/)</td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=34 style='width:26pt'></td>
  <td width=27 style='width:20pt'></td>
  <td width=210 style='width:158pt'></td>
  <td width=365 style='width:274pt'></td>
  <td width=441 style='width:331pt'></td>
 </tr>
 <![endif]>
</table>

</body>

</html>
